{"cells":[{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18258,"status":"ok","timestamp":1702821991981,"user":{"displayName":"곽시헌","userId":"08857774292332952664"},"user_tz":-540},"id":"2OxoBsT6d1ZQ","outputId":"a28264bd-d733-401e-e1f0-9ec222b4db28"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"ahJXsOqoKAFx"},"source":["메인재료 정규화"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4BzKroiU0wY8"},"outputs":[],"source":["import chardet\n","import difflib\n","import pandas as pd\n","\n","# 파일 경로 설정\n","dictionary_filepath = '/content/drive/MyDrive/Colab Notebooks/식재료 사전_식재료 넘버링.xlsx'  # 식재료 사전\n","excel_filepath = '/content/drive/MyDrive/메인_서브/무침_main_sub2.xlsx'  # 정규화한 재료 저장\n","\n","# 엑셀 파일 읽기\n","dictionary_data = pd.read_excel(dictionary_filepath)\n","excel_data = pd.read_excel(excel_filepath)\n","\n","# 유사도 연산에 사용할 열\n","specified_columns = ['식품명', '식품명 동의어', '종류', '종류동의어', '품종', '식품명+가공형태',\n","                     '식품명 동의어+가공형태', '부위', '부위 동의어', '식품명+부위',\n","                     '식품명 동의어+부위', '식품명+부위 동의어', '식품명 동의어+부위 동의어']\n","\n","# 결과를 저장할 DataFrame 초기화\n","result_df = pd.DataFrame(columns=['n_main'])\n","\n","# difflib을 이용한 유사도 판단 및 결과 저장\n","for i, cell_content_main in enumerate(excel_data['main']):\n","    max_similarity_main = 0.0  # 가장 높은 main 열 유사도 초기화\n","    best_match_main = None  # 가장 유사한 main 열 셀 정보 초기화\n","\n","    max_similarity_sub = 0.0  # 가장 높은 sub 열 유사도 초기화\n","    best_match_sub = None  # 가장 유사한 sub 열 셀 정보 초기화\n","\n","    for column in specified_columns:\n","        for j, cell_content_dict in enumerate(dictionary_data[column]):\n","            # main 열 유사도 계산\n","            similarity_ratio_main = difflib.SequenceMatcher(None, str(cell_content_main), str(cell_content_dict)).ratio()\n","            if similarity_ratio_main > max_similarity_main:\n","                max_similarity_main = similarity_ratio_main\n","                best_match_main = {\n","                    'n_main': (dictionary_data.at[j, '식품명 번호'], cell_content_dict),\n","                }\n","\n","    if best_match_main is not None:\n","        result_df = result_df.append({**best_match_main}, ignore_index=True)\n","\n","# 결과를 기존 DataFrame에 추가\n","excel_data = pd.concat([excel_data, result_df], axis=1)\n","\n","# 결과를 Excel 파일로 저장\n","excel_data.to_excel(excel_filepath, index=False)\n","print(f'Results saved to {excel_filepath}')"]},{"cell_type":"markdown","metadata":{"id":"O3FntWbzKRRl"},"source":["서브재료 정규화"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D8APYw2p9sM1","outputId":"3ab60460-5276-47b7-eb94-fd09c5467816"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","<ipython-input-6-953abd7cf87e>:42: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n"]}],"source":["import chardet\n","import difflib\n","import pandas as pd\n","\n","# 파일 경로 설정\n","dictionary_filepath = '/content/drive/MyDrive/Colab Notebooks/식재료 사전_식재료 넘버링.xlsx'  # 식재료 사전\n","excel_filepath = '/content/drive/MyDrive/메인_서브/데치기_main_sub2.xlsx'  # 정규화한 재료 저장\n","\n","# 엑셀 파일 읽기\n","dictionary_data = pd.read_excel(dictionary_filepath)\n","excel_data = pd.read_excel(excel_filepath)\n","\n","# 유사도 연산에 사용할 열\n","specified_columns = ['식품명', '식품명 동의어', '종류', '종류동의어', '품종', '식품명+가공형태',\n","                     '식품명 동의어+가공형태', '부위', '부위 동의어', '식품명+부위',\n","                     '식품명 동의어+부위', '식품명+부위 동의어', '식품명 동의어+부위 동의어']\n","\n","# 결과를 저장할 DataFrame 초기화\n","result_df = pd.DataFrame(columns=['n_sub'])\n","\n","# difflib을 이용한 유사도 판단 및 결과 저장\n","for index, row in excel_data.iterrows():\n","    max_similarity_sub = 0.0  # 가장 높은 sub 열 유사도 초기화\n","    best_match_sub = []  # 모든 유사한 sub 열 셀 정보를 저장할 리스트 초기화\n","\n","    for word_sub in str(row['sub']).split(','):\n","        max_similarity_sub_word = 0.0  # 각 단어에 대한 유사도 초기화\n","        best_match_sub_word = None  # 각 단어에 대한 가장 유사한 sub 열 셀 정보 초기화\n","\n","        for column in specified_columns:\n","            for j, cell_content_dict in enumerate(dictionary_data[column]):\n","                similarity_ratio_sub = difflib.SequenceMatcher(None, word_sub.strip(), str(cell_content_dict)).ratio()\n","                if similarity_ratio_sub > max_similarity_sub_word:\n","                    max_similarity_sub_word = similarity_ratio_sub\n","                    best_match_sub_word = {\n","                        (dictionary_data.at[j, '식품명 번호'], cell_content_dict),\n","                    }\n","\n","        if best_match_sub_word is not None:\n","            best_match_sub.append(best_match_sub_word)\n","\n","    result_df = result_df.append({'n_sub': best_match_sub}, ignore_index=True)\n","\n","# 결과를 기존 DataFrame에 추가\n","excel_data = pd.concat([excel_data, result_df], axis=1)\n","\n","# 결과를 Excel 파일로 저장\n","excel_data.to_excel(excel_filepath, index=False)\n","print(f'Results saved to {excel_filepath}')"]},{"cell_type":"code","source":[],"metadata":{"id":"N2L91uagAiL9"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["엿먹어라. 꺼져 제발."],"metadata":{"id":"CSNYUJOKsqXn"}},{"cell_type":"code","execution_count":38,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"J7pw8wgvgDae","executionInfo":{"status":"ok","timestamp":1702815128793,"user_tz":-540,"elapsed":20968,"user":{"displayName":"곽시헌","userId":"08857774292332952664"}},"outputId":"ba79db1b-f3a0-4b67-80b2-a86bab243763"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","<ipython-input-38-f88febbaaaa0>:58: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n"]},{"output_type":"stream","name":"stdout","text":["Results saved to /content/drive/MyDrive/부침2_main_sub2 - 복사본.xlsx\n","Results saved to /content/drive/MyDrive/부침2_main_sub2 - 복사본.xlsx\n"]}],"source":["import chardet\n","import difflib\n","import pandas as pd\n","\n","# 파일 경로 설정\n","dictionary_filepath = '/content/drive/MyDrive/Colab Notebooks/식재료 사전_식재료 넘버링.xlsx'  # 식재료 사전\n","excel_filepath = '/content/drive/MyDrive/메인_서브/굽기_main_sub2.xlsx'  # 정규화한 재료 저장\n","\n","# 엑셀 파일 읽기\n","dictionary_data = pd.read_excel(dictionary_filepath)\n","excel_data = pd.read_excel(excel_filepath)\n","\n","# 유사도 연산에 사용할 열\n","specified_columns = ['식품명', '식품명 동의어', '종류', '종류동의어', '품종', '식품명+가공형태',\n","                     '식품명 동의어+가공형태', '부위', '부위 동의어', '식품명+부위',\n","                     '식품명 동의어+부위', '식품명+부위 동의어', '식품명 동의어+부위 동의어']\n","\n","# 결과를 저장할 DataFrame 초기화\n","result_df = pd.DataFrame(columns=['n_sub_ver6'])\n","\n","for index, row in excel_data.iterrows():\n","    max_similarity_sub = 0.0  # 가장 높은 sub 열 유사도 초기화\n","    best_match_sub = []  # 모든 유사한 sub 열 셀 정보를 저장할 리스트 초기화\n","\n","    for word_sub in str(row['sub']).split(','):\n","        max_similarity_sub_word = 0.0  # 각 단어에 대한 유사도 초기화\n","        best_match_sub_word = None  # 각 단어에 대한 가장 유사한 sub 열 셀 정보 초기화\n","\n","        for column in specified_columns:\n","            for j, cell_content_dict in enumerate(dictionary_data[column]):\n","                # cell_content_dict가 숫자인 경우 문자열로 변환\n","                cell_content_str = str(cell_content_dict)\n","\n","                # difflib을 이용한 유사도 판단\n","                similarity_ratio_sub = difflib.SequenceMatcher(None, word_sub.strip(), cell_content_str).ratio()\n","                if similarity_ratio_sub > max_similarity_sub_word:\n","                    max_similarity_sub_word = similarity_ratio_sub\n","                    best_match_sub_word = {\n","                        (dictionary_data.at[j, '식품명 번호'], cell_content_str),\n","                    }\n","\n","                # 교집합 여부 확인 (단일 단어에 대한 교집합만 확인)\n","                intersection = False\n","                for a_part in cell_content_str.split():\n","                    if a_part in word_sub:\n","                        intersection = True\n","                        break\n","\n","                # 한 단어에 대한 교집합 확인이 없으면 추가\n","                if not intersection and best_match_sub_word is not None and str(word_sub) != cell_content_str:\n","                    best_match_sub.append(best_match_sub_word)\n","\n","                # 교집합이 발견되면 루프를 종료합니다.\n","                if intersection:\n","                    break\n","\n","    # 하나의 row에 대한 결과를 DataFrame에 추가\n","    result_df = result_df.append({'n_sub_ver6': best_match_sub}, ignore_index=True)\n","\n","# 결과를 기존 DataFrame에 추가\n","excel_data = pd.concat([excel_data, result_df], axis=1)\n","# 결과를 Excel 파일로 저장\n","excel_data.to_excel(excel_filepath, index=False)\n","print(f'Results saved to {excel_filepath}')\n","\n","# 결과를 기존 DataFrame에 추가\n","excel_data = pd.concat([excel_data, result_df], axis=1)\n","# 결과를 Excel 파일로 저장\n","excel_data.to_excel(excel_filepath, index=False)\n","print(f'Results saved to {excel_filepath}')\n","\n"]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyPw97FEwgJAMss+hhiwCUte"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}